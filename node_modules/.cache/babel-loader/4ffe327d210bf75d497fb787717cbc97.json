{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Jorge\\\\Desktop\\\\proyectos\\\\1react\\\\bookshooks\\\\bookshooks\\\\src\\\\context\\\\products.js\";\nimport React from \"react\";\nimport axios from \"axios\";\nimport url from \"../utils/URL\";\nimport { featuredProducts, flattenProducts, paginate } from \"../utils/helpers\";\nexport const ProductContext = React.createContext();\nexport default function ProductProvider({\n  children\n}) {\n  const [loading, setLoading] = React.useState(false);\n  const [products, setProducts] = React.useState([]);\n  const [featured, setFeatured] = React.useState([]); // extra state values\n\n  const [sorted, setSorted] = React.useState([]);\n  const [page, setPage] = React.useState(0);\n  const [filters, setFilters] = React.useState({\n    search: \"\",\n    category: \"all\",\n    shipping: false,\n    price: \"all\"\n  });\n\n  const changePage = index => {\n    setPage(index);\n  };\n\n  const updateFilters = e => {\n    const type = e.target.type;\n    const filter = e.target.name;\n    const value = e.target.value;\n    let filterValue;\n\n    if (type === \"checkbox\") {\n      filterValue = e.target.checked;\n    } else if (type === \"radio\") {\n      value === \"all\" ? filterValue = value : filterValue = parseInt(value);\n    } else {\n      filterValue = value;\n    }\n\n    setFilters({ ...filters,\n      [filter]: filterValue\n    });\n  };\n\n  React.useEffect(() => {\n    setLoading(true);\n    axios.get(`${url}/products`).then(response => {\n      const featured = featuredProducts(flattenProducts(response.data));\n      const products = flattenProducts(response.data);\n      setProducts(products);\n      setSorted(paginate(products));\n      setFeatured(featured);\n      setLoading(false);\n    });\n    return () => {};\n  }, []);\n  React.useLayoutEffect(() => {\n    let newProducts = [...products].sort((a, b) => a.price - b.price);\n    const {\n      search,\n      category,\n      shipping,\n      price\n    } = filters; //\n\n    if (category !== \"all\") {\n      newProducts = newProducts.filter(item => item.category === category);\n    }\n\n    if (shipping !== false) {\n      newProducts = newProducts.filter(item => item.free_shipping === shipping);\n    }\n\n    if (price !== \"all\") {\n      newProducts = newProducts.filter(item => {\n        if (price === 0) {\n          return item.price < 300;\n        } else if (price === 300) {\n          return item.price > 300 && item.price < 650;\n        } else {\n          return item.price > 650;\n        }\n      });\n    }\n\n    if (search !== \"\") {\n      newProducts = newProducts.filter(item => {\n        let title = item.title.toLowerCase().trim();\n        return title.startsWith(search) ? item : null;\n      });\n    }\n\n    setPage(0);\n    setSorted(paginate(newProducts));\n  }, [filters, products]);\n  return /*#__PURE__*/React.createElement(ProductContext.Provider, {\n    value: {\n      products,\n      loading,\n      featured,\n      sorted,\n      page,\n      changePage,\n      filters,\n      updateFilters\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 5\n    }\n  }, children);\n}","map":{"version":3,"sources":["C:/Users/Jorge/Desktop/proyectos/1react/bookshooks/bookshooks/src/context/products.js"],"names":["React","axios","url","featuredProducts","flattenProducts","paginate","ProductContext","createContext","ProductProvider","children","loading","setLoading","useState","products","setProducts","featured","setFeatured","sorted","setSorted","page","setPage","filters","setFilters","search","category","shipping","price","changePage","index","updateFilters","e","type","target","filter","name","value","filterValue","checked","parseInt","useEffect","get","then","response","data","useLayoutEffect","newProducts","sort","a","b","item","free_shipping","title","toLowerCase","trim","startsWith"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport axios from \"axios\";\r\nimport url from \"../utils/URL\";\r\nimport { featuredProducts, flattenProducts, paginate } from \"../utils/helpers\";\r\nexport const ProductContext = React.createContext();\r\n\r\nexport default function ProductProvider({ children }) {\r\n  const [loading, setLoading] = React.useState(false);\r\n  const [products, setProducts] = React.useState([]);\r\n  const [featured, setFeatured] = React.useState([]);\r\n  // extra state values\r\n  const [sorted, setSorted] = React.useState([]);\r\n  const [page, setPage] = React.useState(0);\r\n  const [filters, setFilters] = React.useState({\r\n    search: \"\",\r\n    category: \"all\",\r\n    shipping: false,\r\n    price: \"all\"\r\n  });\r\n  const changePage = index => {\r\n    setPage(index);\r\n  };\r\n  const updateFilters = e => {\r\n    const type = e.target.type;\r\n    const filter = e.target.name;\r\n    const value = e.target.value;\r\n    let filterValue;\r\n    if (type === \"checkbox\") {\r\n      filterValue = e.target.checked;\r\n    } else if (type === \"radio\") {\r\n      value === \"all\" ? (filterValue = value) : (filterValue = parseInt(value));\r\n    } else {\r\n      filterValue = value;\r\n    }\r\n    setFilters({ ...filters, [filter]: filterValue });\r\n  };\r\n\r\n  React.useEffect(() => {\r\n    setLoading(true);\r\n    axios.get(`${url}/products`).then(response => {\r\n      const featured = featuredProducts(flattenProducts(response.data));\r\n      const products = flattenProducts(response.data);\r\n      setProducts(products);\r\n      setSorted(paginate(products));\r\n      setFeatured(featured);\r\n      setLoading(false);\r\n    });\r\n    return () => {};\r\n  }, []);\r\n  React.useLayoutEffect(() => {\r\n    let newProducts = [...products].sort((a, b) => a.price - b.price);\r\n    const { search, category, shipping, price } = filters;\r\n    //\r\n    if (category !== \"all\") {\r\n      newProducts = newProducts.filter(item => item.category === category);\r\n    }\r\n    if (shipping !== false) {\r\n      newProducts = newProducts.filter(item => item.free_shipping === shipping);\r\n    }\r\n    if (price !== \"all\") {\r\n      newProducts = newProducts.filter(item => {\r\n        if (price === 0) {\r\n          return item.price < 300;\r\n        } else if (price === 300) {\r\n          return item.price > 300 && item.price < 650;\r\n        } else {\r\n          return item.price > 650;\r\n        }\r\n      });\r\n    }\r\n    if (search !== \"\") {\r\n      newProducts = newProducts.filter(item => {\r\n        let title = item.title.toLowerCase().trim();\r\n        return title.startsWith(search) ? item : null;\r\n      });\r\n    }\r\n\r\n    setPage(0);\r\n\r\n    setSorted(paginate(newProducts));\r\n  }, [filters, products]);\r\n  return (\r\n    <ProductContext.Provider\r\n      value={{\r\n        products,\r\n        loading,\r\n        featured,\r\n        sorted,\r\n        page,\r\n        changePage,\r\n        filters,\r\n        updateFilters\r\n      }}\r\n    >\r\n      {children}\r\n    </ProductContext.Provider>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}